# Application name
spring.application.name=scotaccountclient

# Server error configuration
server.error.include-message=always
server.error.include-exception=true
server.error.include-stacktrace=on_param
server.error.include-binding-errors=always

# OAuth2 Client Configuration
spring.security.oauth2.client.registration.scotaccount.client-id=6ovfxtjaivlpy
spring.security.oauth2.client.registration.scotaccount.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.scotaccount.scope=openid,scotaccount.address,scotaccount.email
spring.security.oauth2.client.registration.scotaccount.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# OAuth2 Provider Configuration
spring.security.oauth2.client.provider.scotaccount.issuer-uri=https://authz.integration.scotaccount.service.gov.scot
spring.security.oauth2.client.provider.scotaccount.authorization-uri=${spring.security.oauth2.client.provider.scotaccount.issuer-uri}/authorize
spring.security.oauth2.client.provider.scotaccount.token-uri=${spring.security.oauth2.client.provider.scotaccount.issuer-uri}/token
spring.security.oauth2.client.provider.scotaccount.jwk-set-uri=${spring.security.oauth2.client.provider.scotaccount.issuer-uri}/jwks.json
spring.security.oauth2.client.provider.scotaccount.user-info-uri=https://issuer.main.integration.scotaccount.service.gov.scot/attributes/values
spring.security.oauth2.client.provider.scotaccount.user-name-attribute=sub

# Custom Configuration
scotaccount.logout-endpoint=${spring.security.oauth2.client.provider.scotaccount.issuer-uri}/authorize/logout

# Key Configuration
scotaccount.private-key-path=keys/ec_private_key.pem
scotaccount.public-key-path=keys/ec_public_key.pem

# Session Configuration
server.servlet.session.cookie.name=SCOTACCOUNT_SESSION
server.servlet.session.timeout=60m
# SameSite cookie configuration for OAuth2 flow
# server.servlet.session.cookie.same-site=lax
server.port=8090
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true

# Logging Configuration
logging.level.root=INFO
logging.level.scot.gov.scotaccountclient=TRACE
logging.level.scot.gov.WebConfig=TRACE
logging.level.org.springframework.web.client=TRACE
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.oauth2=TRACE
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.http=TRACE
# Suppress access denied exceptions for anonymous users (normal operation)
logging.level.org.springframework.security.web.access.ExceptionTranslationFilter=INFO

# Additional OAuth2 and HTTP logging for ScotAccount debugging
logging.level.org.springframework.security.oauth2.client=TRACE
logging.level.org.springframework.security.oauth2.client.web=TRACE
logging.level.org.springframework.security.oauth2.client.endpoint=TRACE
logging.level.org.springframework.security.oauth2.core=TRACE
logging.level.org.springframework.security.oauth2.jwt=TRACE
logging.level.org.springframework.security.oauth2.jose=TRACE
logging.level.org.springframework.web.client.RestTemplate=TRACE
logging.level.org.apache.http=TRACE
logging.level.org.apache.http.wire=TRACE
logging.level.org.apache.http.headers=TRACE

# Log file configuration - reset on restart
logging.file.name=logs/application.log
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=5
logging.logback.rollingpolicy.clean-history-on-start=true
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n



# DevTools Configuration
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true
spring.thymeleaf.cache=false